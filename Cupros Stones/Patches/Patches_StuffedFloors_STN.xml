<?xml version="1.0" encoding="utf-8" ?>
<Patch>

	<!-- If Stuffed Floors is not found, add the designation category and assign it -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<Operations>
			<li Class="CuprosStones.PatchOperationFindMod">
				<modName>Stuffed Floors</modName>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationInsert">
				<success>Always</success>
				<xpath>/Defs/DesignationCategoryDef[@Name="STN_DesignationInsertion"]</xpath>
				<Order>Prepend</Order>
				<value>
					<DesignationCategoryDef>
						<DefName>STN_Floors</DefName>
						<label>Stone Floors</label>
						<description>Stone floors added by Cupro's Stones.</description>
						<order>210</order>
						<specialDesignatorClasses>
							<li>Designator_Cancel</li>
							<li>Designator_SmoothFloor</li>
							<li>Designator_RemoveFloor</li>
						</specialDesignatorClasses>
					</DesignationCategoryDef>  
				</value>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>/Defs/TerrainDef[@Name = "STN_FloorBase"]/designationCategory</xpath>
				<value>
					<designationCategory>STN_Floors</designationCategory>
				</value>
			</li>
		</Operations>
	</Operation>

	<!-- If Stuffed Floors is found, add my floors to the obsoletes -->
	<Operation Class="PatchOperationSequence">
		<success>Always</success>
		<Operations>
			<li Class="CuprosStones.PatchOperationFindMod">
				<modName>Stuffed Floors</modName>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ArchitectSense.DesignationSubCategoryDef[defName="SubCategory_Flagstones"]/defNames</xpath>
				<value>
					<li>FlagstoneClaystone</li>
					<li>FlagstoneAndesite</li>
					<li>FlagstoneRhyolite</li>
					<li>FlagstoneGneiss</li>
					<li>FlagstoneQuartzite</li>
					<li>FlagstoneSchist</li>
					<li>FlagstoneGabbro</li>
					<li>FlagstoneDiorite</li>
					<li>FlagstoneDunite</li>
					<li>FlagstonePegmatite</li>
					<!-- This layout will likely change in the future with the addition of A17 tiles. It at least reduces clutter for now -->
					<!-- For now I'll add these here to remove them, adding to obsoletes or creating a subcategory didn't work -->
					<li>TileClaystone</li>
					<li>TileAndesite</li>
					<li>TileRhyolite</li>
					<li>TileGneiss</li>
					<li>TileQuartzite</li>
					<li>TileSchist</li>
					<li>TileGabbro</li>
					<li>TileDiorite</li>
					<li>TileDunite</li>
					<li>TilePegmatite</li>
				</value>
			</li>
		</Operations>
	</Operation>

</Patch>